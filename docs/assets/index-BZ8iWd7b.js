(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();const p={hour:"2-digit",minute:"2-digit",second:"2-digit"},v={day:"2-digit",month:"long",weekday:"long"};let c=new Date;function h(){const t=document.querySelector(".time"),e=document.querySelector(".date");t.textContent=c.toLocaleTimeString("ru-RU",p),e.textContent=c.toLocaleDateString("ru-RU",v),k()&&window.dispatchEvent(new Event("newHour"))}function k(){let t,e;return t=c.getHours(),c=new Date,e=c.getHours(),t!==e}function m(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t}const s={night:[22,23,0,1,2,3],morning:[4,5,6,7,8,9],day:[10,11,12,13,14,15],evening:[16,17,18,19,20,21]};function g(t){const e=l(t);D(),L(e),console.log("Background has changed")}function _(){const e=document.querySelector(".background__item--showing[data-time]").dataset.time;let n=m(0,23),a=e!==l(n);for(;!a;)n=m(0,23),a=e!==l(n);a&&g(n)}function D(){document.querySelectorAll("[data-time]").forEach(e=>e.classList.remove("background__item--showing"))}function L(t){const e=document.querySelector(`[data-time=${t}]`);e&&e.classList.add("background__item--showing")}function l(t){let e;return s.night.includes(t)?e="night":s.morning.includes(t)?e="morning":s.day.includes(t)?e="day":s.evening.includes(t)&&(e="evening"),e}window.addEventListener("newHour",()=>{g(c.getHours())});const u={clearWeather:[0,1,2,3],cloudyWeather:[45,48,51,53,55,56,57],rainyWeather:[61,63,65,66,67,80,81,82,95,96,99],snowyWeather:[71,73,75,77,85,86]};function C(t){let e="";return u.clearWeather.includes(t)?e="sun-icon":u.cloudyWeather.includes(t)?e="cloud-icon":u.rainyWeather.includes(t)?e="rain-icon":u.snowyWeather.includes(t)&&(e="snow-icon"),e}let d="Москва";async function f(t){const e=document.querySelector(".utility__value"),n=document.querySelector(".city");let{temperature:a,city:o,wmoCode:r}=await W(t),i=document.querySelector(".weather .utility__value");e.textContent="",e.textContent+=`${a}°`,n.textContent="",n.textContent+=`${o}`,i.classList.remove("sun-icon","cloud-icon","rain-icon","snow-icon"),i.classList.add(C(r)),console.log("Weather has rendered")}async function y(){if(d=prompt("Укажите город",""),!!d)try{await f(d)}catch{alert("Неправильно указан город"),y()}}async function W(t){const e={},n=await w(t),a=await B(t);let o=Math.round(a.current.temperature_2m);return e.temperature=o,e.city=n.city,e.wmoCode=a.current.weather_code,e}async function w(t){const e=await S(t),n={};return n.latitude=e.results[0].latitude,n.longitude=e.results[0].longitude,n.city=e.results[0].name,n}async function S(t){let e=await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${t}&count=1&language=ru&format=json`);return e=await e.json(),e}async function B(t){const e=await w(t);let n=await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${e.latitude}&longitude=${e.longitude}&current=temperature_2m,precipitation,rain,showers,snowfall,weather_code,cloud_cover&timezone=Europe%2FMoscow&forecast_days=1`);return n=await n.json(),n}window.addEventListener("newHour",()=>{f()});h();setInterval(h,1e3);f("Москва");g(c.getHours());const E=document.querySelector(".random-background");E.addEventListener("click",()=>_());const q=document.querySelector(".change-city");q.addEventListener("click",()=>y());
